function sloth(){}sloth.onDomReady=function(a,b){new(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(a){a.forEach(function(a){b()})}).observe(a,{attributes:!0,childList:!0,characterData:!0})},sloth.Component=function(){},sloth.__components={},sloth.Component.__pending_components={},sloth.Component._global_renderer=[],sloth.Component.register_render_callback=function(a){sloth.Component._global_renderer.push(a)},sloth.Component.register=function(a,b){a._comp_loading=!1,a.__loadlist=[];var c={classObject:a,deps:b,then:function(a){this.callback=a,this.singleton&&this.callback.bind(this.singleton)()},singleton:null};return sloth.Component.__pending_components[a.name]=c,sloth.Component._load_them(),c},sloth.Component.domReady=function(){for(var a in sloth.__components){var b=sloth.__components[a];b.__isloaded&&!b.__attached&&b.dom_id&&b.__attach(),b.__attached=!0}},sloth.Component.init=function(a){var b=new(Function.prototype.bind.apply(a,arguments));b.attach=function(c){var d=void 0===a.shell?"div":a.shell,e=document.createElement(d);return e.id=(Date.now().toString()+Math.random().toString()).substr(8,16),b.dom_id=e.id,b.__torender=!0,e.innerHTML=b.template(),sloth.onDomReady(c,function(){b.__torender&&(console.log(b.constructor.name+" render"),void 0!==b.render&&b.render(e),sloth.Component._global_renderer.forEach(function(a){a()}),b.__torender=!1)}),c.appendChild(e),e};var c={};b.loaded=function(){c.resolve(b)};var d=new Promise(function(a){c.resolve=a});return sloth.Component.__init(b),b.__load(),d},sloth.Component.__init=function(a){a.__attached=!1,a.__torender=!1,a.templateUrl=function(){return a.__proto__.constructor.templateUrl},a.template=function(){return a.__proto__.constructor.template},a.__isloaded=!!a.template(),a.__display=function(){console.log("Attaching to dom"),a.__torender=!0,a.__dom.innerHTML=a.template()},a.__attach=function(b){a.__dom=document.getElementById(this.dom_id),sloth.onDomReady(a.__dom,function(){a.__torender&&(console.log(a.constructor.name+" render"),void 0!==a.render&&a.render(a.__dom),sloth.Component._global_renderer.forEach(function(a){a()}),a.__torender=!1)}),(void 0==b||b)&&a.__display()},void 0!==a.dom_id&&(a.__dom=document.getElementById(this.dom_id),a.__dom&&(a.__attach(),a.__attached=!0)),a.__loaded=function(){void 0===a.loaded?a.__attached&&(a.dom_id&&a.__attach(!1),a.__display()):a.loaded()},a.__load=function(){if(a.__proto__.constructor._comp_loading)return void a.__proto__.constructor.__loadlist.push(a);if(this.__isloaded)a.__loaded();else{a.__proto__.constructor._comp_loading=!0;var b=function(a){return 200===a.status||0===a.status?a.text():new Error(a.statusText)};fetch(a.templateUrl()).then(b).then(function(b){a.__proto__.constructor.template=b,a.__isloaded=!0,a.__loaded(),a.__proto__.constructor._comp_loading=!1,a.__proto__.constructor.__loadlist.forEach(function(a){a.__loaded()})}).catch()}},void 0!==a.dom_id&&a.__attached&&a.__display(),a.refresh=function(){this.__attached&&(a.dom_id&&a.__attach(!1),a.__display())}},sloth.Component._load_them=function(){var a=[];for(var b in sloth.Component.__pending_components)a.push(b);var c=!1;a.forEach(function(a){var b=sloth.Component.__pending_components[a],d=b.classObject,e=[null];if(void 0!==b.deps){for(var f=!0,g=0;g<b.deps.length;g++){var h=sloth.__components[b.deps[g]],i=sloth.Services._services[b.deps[g]];if(void 0==h&&void 0==i){f=!1;break}void 0!=h&&e.push(h),void 0!=i&&e.push(i)}if(!f)return}var j=new(Function.prototype.bind.apply(d,e));e.forEach(function(a){null!=a&&a.constructor.name in sloth.Services._services&&a.__listeners.push(j)}),delete sloth.Component.__pending_components[a],sloth.__components[a]=j,sloth.Component.__init(j),void 0!==b.callback&&b.callback.bind(j)(),b.singleton=j,c=!0}),c&&this._load_them()},sloth.Services=function(){},sloth.Services._services={},sloth.Services.register=function(a){a.__listeners=[],a.notify=function(b){void 0==b&&(b={}),b.service=a,this.__listeners.forEach(function(a){void 0===a.event_triggered?console.error(a.constructor.name+" doesn't implement the event_triggered callback"):a.event_triggered(b)})},sloth.Services._services[a.__proto__.constructor.name]=a,sloth.Component._load_them()},sloth.Services.get=function(a){return sloth.Services._services[a]},sloth.Router=function(){this.__routes={},this.__current_route=window.location.hash,this.__dom=document.getElementById("router_id"),this.__default_route=null;var a=this;sloth.onDomReady(this.__dom,function(){var b=a.__routes[a.__current_route];b[1].__torender&&(void 0!==b[1].render&&(b[1].render(a.__dom),sloth.Component._global_renderer.forEach(function(a){a()})),b[1].__torender=!1)}),window.onhashchange=function(){a.__current_route=window.location.hash,a.update(window.location.hash)}},sloth.Router.prototype.start=function(){window.location.hash&&""!=window.location.hash?this.__current_route=window.location.hash:window.location.hash=this.__default_route},sloth.Router.prototype.add_route=function(a,b,c,d,e){var f=this;c.default_route&&(null!=this.__default_route&&console.error("Default route already set to "+this.__default_route+" forcing to "+a),this.__default_route=a),sloth.Component.register(c,e).then(function(){f.__routes[a]=[b,this,d],null==f.__current_route&&(f.__current_route=a),a==f.__current_route&&f.update()})},sloth.Router.prototype.update=function(){var a=this.__routes[this.__current_route];if(a[1].dom_id=null,a=this.__routes[window.location.hash],a[1].dom_id=this.__dom.id,void 0!==a){if(void 0!==a[2]){var b=a[2]();if(!0!==b)return window.location.hash=b,this.update()}a[1].__load()}},sloth.Router.navigate=function(a){for(var b in __main_router.__routes){if(__main_router.__routes[b][0]==a)return void(window.location.hash=b)}};var __main_router=null;sloth.RouterConfig=function(a){return __main_router=new sloth.Router,a.forEach(function(a){__main_router.add_route.apply(__main_router,a)}),__main_router};